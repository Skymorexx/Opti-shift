*** Begin Patch
*** Update File: app.py
@@
-            else:
-                current_assignments = modified_assignments
-                assignment_lookup = {item["slot_id"]: item for item in current_assignments}
-                if submit_action == "save":
+            else:
+                current_assignments = modified_assignments
+                assignment_lookup = {
+                    item["slot_id"]: item
+                    for item in current_assignments
+                    if item.get("slot_id")
+                }
+                slot_kind_map = {
+                    assignment["slot_id"]: determine_slot_kind(assignment)
+                    for assignment in current_assignments
+                    if assignment.get("slot_id")
+                }
+                if submit_action == "save":
*** End Patch
